<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Playwright Demo – Todo App</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: system-ui, -apple-system, sans-serif;
      background: #f5f5f5;
      color: #333;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      padding: 2rem 1rem;
    }

    main { width: 100%; max-width: 540px; }

    h1 {
      text-align: center;
      font-size: 3rem;
      color: #b83f45;
      margin-bottom: 1.5rem;
      font-weight: 100;
      letter-spacing: -2px;
    }

    #todo-form {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 0.75rem;
    }

    #new-todo {
      flex: 1;
      padding: 0.875rem 1rem;
      font-size: 1rem;
      border: 1px solid #ddd;
      border-radius: 4px;
      outline: none;
    }
    #new-todo:focus { border-color: #b83f45; box-shadow: 0 0 0 2px rgba(184,63,69,.2); }

    #add-button {
      padding: 0.875rem 1.25rem;
      background: #b83f45;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 500;
    }
    #add-button:hover { background: #9c3038; }
    #add-button:disabled { background: #ccc; cursor: not-allowed; }

    #todo-list {
      list-style: none;
      background: #fff;
      border-radius: 4px;
      box-shadow: 0 2px 8px rgba(0,0,0,.08);
    }

    .todo-item {
      display: flex;
      align-items: center;
      padding: 1rem;
      border-bottom: 1px solid #f0f0f0;
      gap: 0.75rem;
    }
    .todo-item:last-child { border-bottom: none; }
    .todo-item.completed .todo-label {
      text-decoration: line-through;
      color: #aaa;
    }

    .todo-checkbox { width: 20px; height: 20px; cursor: pointer; accent-color: #b83f45; }
    .todo-label { flex: 1; font-size: 1rem; }

    .delete-btn {
      background: none;
      border: none;
      cursor: pointer;
      color: #ccc;
      font-size: 1.25rem;
      line-height: 1;
      padding: 0 0.25rem;
      transition: color .15s;
    }
    .delete-btn:hover { color: #b83f45; }

    #empty-msg {
      text-align: center;
      color: #bbb;
      padding: 2.5rem 1rem;
      font-style: italic;
      background: #fff;
      border-radius: 4px;
      box-shadow: 0 2px 8px rgba(0,0,0,.08);
    }

    #footer {
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 0.5rem;
      background: #fff;
      padding: 0.75rem 1rem;
      margin-top: 0.75rem;
      border-radius: 4px;
      box-shadow: 0 2px 8px rgba(0,0,0,.08);
      font-size: 0.875rem;
    }
    #footer[hidden] { display: none; }

    #todo-count { color: #777; }

    #filters { display: flex; gap: 0.25rem; }
    .filter-btn {
      padding: 0.2rem 0.6rem;
      border: 1px solid transparent;
      border-radius: 4px;
      background: none;
      cursor: pointer;
      font-size: 0.875rem;
    }
    .filter-btn:hover { border-color: #ddd; }
    .filter-btn[aria-pressed="true"] { border-color: #b83f45; color: #b83f45; }

    #clear-completed {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 0.875rem;
      color: #aaa;
    }
    #clear-completed:hover { color: #333; }
    #clear-completed[hidden] { display: none; }
  </style>
</head>
<body>
  <main>
    <h1>todos</h1>

    <form id="todo-form" aria-label="Add todo">
      <input
        type="text"
        id="new-todo"
        name="todo"
        placeholder="What needs to be done?"
        aria-label="New todo"
        autocomplete="off"
      />
      <button type="submit" id="add-button">Add</button>
    </form>

    <ul id="todo-list" role="list" aria-label="Todo list"></ul>
    <p id="empty-msg">No todos yet — add one above!</p>

    <footer id="footer" hidden aria-label="Footer">
      <span id="todo-count" aria-live="polite"></span>

      <div id="filters" role="group" aria-label="Filter todos">
        <button class="filter-btn" data-filter="all"       aria-pressed="true">All</button>
        <button class="filter-btn" data-filter="active"    aria-pressed="false">Active</button>
        <button class="filter-btn" data-filter="completed" aria-pressed="false">Completed</button>
      </div>

      <button id="clear-completed" hidden>Clear completed</button>
    </footer>
  </main>

  <script>
    const STORAGE_KEY = 'playwright-demo-todos';

    let todos = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
    let currentFilter = 'all';

    const form     = document.getElementById('todo-form');
    const input    = document.getElementById('new-todo');
    const list     = document.getElementById('todo-list');
    const footer   = document.getElementById('footer');
    const countEl  = document.getElementById('todo-count');
    const clearBtn = document.getElementById('clear-completed');
    const emptyMsg = document.getElementById('empty-msg');

    function save() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(todos));
    }

    function render() {
      const filtered = todos.filter(t => {
        if (currentFilter === 'active')    return !t.completed;
        if (currentFilter === 'completed') return  t.completed;
        return true;
      });

      list.innerHTML = '';

      filtered.forEach(todo => {
        const li  = document.createElement('li');
        li.className = 'todo-item' + (todo.completed ? ' completed' : '');
        li.dataset.id = String(todo.id);

        const cb = document.createElement('input');
        cb.type      = 'checkbox';
        cb.className = 'todo-checkbox';
        cb.checked   = todo.completed;
        cb.setAttribute('aria-label', todo.text);
        cb.addEventListener('change', () => toggle(todo.id));

        const label = document.createElement('span');
        label.className   = 'todo-label';
        label.textContent = todo.text;

        const del = document.createElement('button');
        del.className   = 'delete-btn';
        del.textContent = '✕';
        del.setAttribute('aria-label', 'Delete ' + todo.text);
        del.addEventListener('click', () => remove(todo.id));

        li.append(cb, label, del);
        list.appendChild(li);
      });

      const activeCount = todos.filter(t => !t.completed).length;
      countEl.textContent = `${activeCount} item${activeCount !== 1 ? 's' : ''} left`;

      clearBtn.hidden  = !todos.some(t => t.completed);
      footer.hidden    = todos.length === 0;
      emptyMsg.hidden  = todos.length > 0;

      document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.setAttribute('aria-pressed', String(btn.dataset.filter === currentFilter));
      });
    }

    function add(text) {
      text = text.trim();
      if (!text) return;
      todos.push({ id: Date.now(), text, completed: false });
      save();
      render();
    }

    function toggle(id) {
      todos = todos.map(t => t.id === id ? { ...t, completed: !t.completed } : t);
      save();
      render();
    }

    function remove(id) {
      todos = todos.filter(t => t.id !== id);
      save();
      render();
    }

    form.addEventListener('submit', e => {
      e.preventDefault();
      add(input.value);
      input.value = '';
    });

    clearBtn.addEventListener('click', () => {
      todos = todos.filter(t => !t.completed);
      save();
      render();
    });

    document.getElementById('filters').addEventListener('click', e => {
      if (!e.target.dataset.filter) return;
      currentFilter = e.target.dataset.filter;
      render();
    });

    render();
  </script>
</body>
</html>
